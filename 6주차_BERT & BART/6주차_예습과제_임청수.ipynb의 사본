{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"1gFrIhJpBpXQtHrU7PuXWfMbN5iCQgum9","timestamp":1677062464513}],"machine_shape":"hm"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"bf3f60940e6746e6b6b729874aba4585":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_c363ad442b744f1aada71422e1ade3e2","IPY_MODEL_0462f06085054c7eb85ae148433525d6","IPY_MODEL_1b36eb7a49ff4c61b85e54d9563aa867"],"layout":"IPY_MODEL_a31aebf2a84c4447a65eccc5fc765ba0"}},"c363ad442b744f1aada71422e1ade3e2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_47b0405454e54d79b0fc85127abad7ce","placeholder":"​","style":"IPY_MODEL_13754f6b68844029bc0d0da4a2efd3b2","value":"Downloading (…)lve/main/config.json: 100%"}},"0462f06085054c7eb85ae148433525d6":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_3c28686c60034ba5892eb9b8d623aa1a","max":1000,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f83aa887757b4f7bbd07f31ab4e7915b","value":1000}},"1b36eb7a49ff4c61b85e54d9563aa867":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_798bead4c8ca4cc48bd0e72fa405f75d","placeholder":"​","style":"IPY_MODEL_55dc50d06341464d8578b9214fbc54a1","value":" 1.00k/1.00k [00:00&lt;00:00, 25.5kB/s]"}},"a31aebf2a84c4447a65eccc5fc765ba0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"47b0405454e54d79b0fc85127abad7ce":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"13754f6b68844029bc0d0da4a2efd3b2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3c28686c60034ba5892eb9b8d623aa1a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f83aa887757b4f7bbd07f31ab4e7915b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"798bead4c8ca4cc48bd0e72fa405f75d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"55dc50d06341464d8578b9214fbc54a1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"bb4f2f9c074a41bc98b77624af9da76e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f71e5108453349cf97e9bc6915a4e346","IPY_MODEL_c4eab82f5e89432bbe34c5e7f435d3d8","IPY_MODEL_75398e37cf774c69b33f9ac885eb600e"],"layout":"IPY_MODEL_4e28b1b7035b429eaf833e1dfd71d601"}},"f71e5108453349cf97e9bc6915a4e346":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_00d7c41492ac4596bc2ef426442b8066","placeholder":"​","style":"IPY_MODEL_e078945bb80d4e0d9cc9cb669dfe797c","value":"Downloading (…)/main/tokenizer.json: 100%"}},"c4eab82f5e89432bbe34c5e7f435d3d8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_72b4a048abed478d856799478eb74514","max":2825034,"min":0,"orientation":"horizontal","style":"IPY_MODEL_c3cac405e2d846dca5084767f2a939a2","value":2825034}},"75398e37cf774c69b33f9ac885eb600e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5932d815058c440d83aab7f45cf339af","placeholder":"​","style":"IPY_MODEL_15267635995f4433b032bb48a6ea0366","value":" 2.83M/2.83M [00:00&lt;00:00, 5.79MB/s]"}},"4e28b1b7035b429eaf833e1dfd71d601":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"00d7c41492ac4596bc2ef426442b8066":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e078945bb80d4e0d9cc9cb669dfe797c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"72b4a048abed478d856799478eb74514":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c3cac405e2d846dca5084767f2a939a2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5932d815058c440d83aab7f45cf339af":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"15267635995f4433b032bb48a6ea0366":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b26be6665085438fbef8b1fb7ea79df9":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_00ace0181b1c4ebe8d432dd2715ee305","IPY_MODEL_e1315141b9404e069046d887f0d644a8","IPY_MODEL_5f07e7e4d4c045bd90c8573ec13bc36d"],"layout":"IPY_MODEL_6917c3dbece247759d1b5c6162ee04e6"}},"00ace0181b1c4ebe8d432dd2715ee305":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e79c3b54e05048e6a25368d73382d433","placeholder":"​","style":"IPY_MODEL_56403825a0564048b0be1123c689ff5a","value":"Downloading (…)&quot;pytorch_model.bin&quot;;: 100%"}},"e1315141b9404e069046d887f0d644a8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4dedebf671d74731a177f94ef6f25dc2","max":513302779,"min":0,"orientation":"horizontal","style":"IPY_MODEL_4a9e39b2730344faa7dc46812801c62c","value":513302779}},"5f07e7e4d4c045bd90c8573ec13bc36d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_25d8f32ccab841bba53fad8fc5d2ebc5","placeholder":"​","style":"IPY_MODEL_7e04832b650f4a5580c527e20c3dc060","value":" 513M/513M [00:03&lt;00:00, 239MB/s]"}},"6917c3dbece247759d1b5c6162ee04e6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e79c3b54e05048e6a25368d73382d433":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"56403825a0564048b0be1123c689ff5a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4dedebf671d74731a177f94ef6f25dc2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4a9e39b2730344faa7dc46812801c62c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"25d8f32ccab841bba53fad8fc5d2ebc5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7e04832b650f4a5580c527e20c3dc060":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}},"gpuClass":"standard"},"cells":[{"cell_type":"markdown","source":["# 6주차 예습과제 _ kogpt2 문장 생성"],"metadata":{"id":"HZ_FlRKaiG0Q"}},{"cell_type":"markdown","source":["참고 자료 : https://github.com/ukairia777/tensorflow-nlp-tutorial/blob/main/22.%20Fine-tuning%20GPT-2%20(Cls%2C%20Chatbot%2C%20NLI)/22-2.%20kogpt2_text_generation_gpu.ipynb\n"],"metadata":{"id":"57lSa__Mwv4H"}},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qVRPI40E9p60","outputId":"66abc51c-3749-4d2f-e49f-dddaea617223","executionInfo":{"status":"ok","timestamp":1677062530817,"user_tz":-540,"elapsed":18031,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"source":["!pip install transformers"],"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers\n","  Downloading transformers-4.26.1-py3-none-any.whl (6.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m6.3/6.3 MB\u001b[0m \u001b[31m48.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.8/dist-packages (from transformers) (6.0)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.8/dist-packages (from transformers) (4.64.1)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1\n","  Downloading tokenizers-0.13.2-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.6/7.6 MB\u001b[0m \u001b[31m74.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.8/dist-packages (from transformers) (23.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.8/dist-packages (from transformers) (3.9.0)\n","Collecting huggingface-hub<1.0,>=0.11.0\n","  Downloading huggingface_hub-0.12.1-py3-none-any.whl (190 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m190.3/190.3 KB\u001b[0m \u001b[31m14.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.8/dist-packages (from transformers) (1.21.6)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.8/dist-packages (from transformers) (2022.6.2)\n","Requirement already satisfied: requests in /usr/local/lib/python3.8/dist-packages (from transformers) (2.25.1)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.8/dist-packages (from huggingface-hub<1.0,>=0.11.0->transformers) (4.5.0)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.8/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.8/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.8/dist-packages (from requests->transformers) (2022.12.7)\n","Requirement already satisfied: chardet<5,>=3.0.2 in /usr/local/lib/python3.8/dist-packages (from requests->transformers) (4.0.0)\n","Installing collected packages: tokenizers, huggingface-hub, transformers\n","Successfully installed huggingface-hub-0.12.1 tokenizers-0.13.2 transformers-4.26.1\n"]}]},{"cell_type":"markdown","source":["# 1. KoGPT2로 문장 생성하기"],"metadata":{"id":"jsMlHYSWxgwn"}},{"cell_type":"code","metadata":{"id":"_v74ax3U92dc","executionInfo":{"status":"ok","timestamp":1677062544429,"user_tz":-540,"elapsed":9257,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"source":["import tensorflow as tf\n","from transformers import AutoTokenizer\n","from transformers import TFGPT2LMHeadModel"],"execution_count":2,"outputs":[]},{"cell_type":"code","source":["# 사전 학습된 kogpt2 토크나이저와 모델 \n","tokenizer = AutoTokenizer.from_pretrained('skt/kogpt2-base-v2')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":175,"referenced_widgets":["bf3f60940e6746e6b6b729874aba4585","c363ad442b744f1aada71422e1ade3e2","0462f06085054c7eb85ae148433525d6","1b36eb7a49ff4c61b85e54d9563aa867","a31aebf2a84c4447a65eccc5fc765ba0","47b0405454e54d79b0fc85127abad7ce","13754f6b68844029bc0d0da4a2efd3b2","3c28686c60034ba5892eb9b8d623aa1a","f83aa887757b4f7bbd07f31ab4e7915b","798bead4c8ca4cc48bd0e72fa405f75d","55dc50d06341464d8578b9214fbc54a1","bb4f2f9c074a41bc98b77624af9da76e","f71e5108453349cf97e9bc6915a4e346","c4eab82f5e89432bbe34c5e7f435d3d8","75398e37cf774c69b33f9ac885eb600e","4e28b1b7035b429eaf833e1dfd71d601","00d7c41492ac4596bc2ef426442b8066","e078945bb80d4e0d9cc9cb669dfe797c","72b4a048abed478d856799478eb74514","c3cac405e2d846dca5084767f2a939a2","5932d815058c440d83aab7f45cf339af","15267635995f4433b032bb48a6ea0366"]},"id":"OjQp-aJu1A8Y","outputId":"546599a1-326f-4c11-e3fa-34f8c17f3bb1","executionInfo":{"status":"ok","timestamp":1677062550984,"user_tz":-540,"elapsed":3965,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"execution_count":3,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/1.00k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"bf3f60940e6746e6b6b729874aba4585"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)/main/tokenizer.json:   0%|          | 0.00/2.83M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"bb4f2f9c074a41bc98b77624af9da76e"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.\n"]}]},{"cell_type":"code","source":["model = TFGPT2LMHeadModel.from_pretrained('skt/kogpt2-base-v2', from_pt=True)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":187,"referenced_widgets":["b26be6665085438fbef8b1fb7ea79df9","00ace0181b1c4ebe8d432dd2715ee305","e1315141b9404e069046d887f0d644a8","5f07e7e4d4c045bd90c8573ec13bc36d","6917c3dbece247759d1b5c6162ee04e6","e79c3b54e05048e6a25368d73382d433","56403825a0564048b0be1123c689ff5a","4dedebf671d74731a177f94ef6f25dc2","4a9e39b2730344faa7dc46812801c62c","25d8f32ccab841bba53fad8fc5d2ebc5","7e04832b650f4a5580c527e20c3dc060"]},"id":"-B_owlsn1D85","outputId":"a06c9a98-09c0-48e8-cdf0-7a2b9d8c7749","executionInfo":{"status":"ok","timestamp":1677062575598,"user_tz":-540,"elapsed":14023,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"execution_count":4,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)\"pytorch_model.bin\";:   0%|          | 0.00/513M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b26be6665085438fbef8b1fb7ea79df9"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of the PyTorch model were not used when initializing the TF 2.0 model TFGPT2LMHeadModel: ['transformer.h.8.attn.masked_bias', 'transformer.h.0.attn.masked_bias', 'transformer.h.1.attn.masked_bias', 'transformer.h.2.attn.masked_bias', 'transformer.h.3.attn.masked_bias', 'transformer.h.11.attn.masked_bias', 'lm_head.weight', 'transformer.h.9.attn.masked_bias', 'transformer.h.5.attn.masked_bias', 'transformer.h.7.attn.masked_bias', 'transformer.h.10.attn.masked_bias', 'transformer.h.4.attn.masked_bias', 'transformer.h.6.attn.masked_bias']\n","- This IS expected if you are initializing TFGPT2LMHeadModel from a PyTorch model trained on another task or with another architecture (e.g. initializing a TFBertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing TFGPT2LMHeadModel from a PyTorch model that you expect to be exactly identical (e.g. initializing a TFBertForSequenceClassification model from a BertForSequenceClassification model).\n","All the weights of TFGPT2LMHeadModel were initialized from the PyTorch model.\n","If your task is similar to the task the model of the checkpoint was trained on, you can already use TFGPT2LMHeadModel for predictions without further training.\n"]}]},{"cell_type":"code","source":["sent = '점심 메뉴를 정하기 위해서는'"],"metadata":{"id":"Uqja8V1N7dRQ","executionInfo":{"status":"ok","timestamp":1677063458822,"user_tz":-540,"elapsed":377,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"execution_count":17,"outputs":[]},{"cell_type":"code","source":["# 생성 모델 입력값에 필요한 형태로 변환\n","input_ids = tokenizer.encode(sent)\n","input_ids = tf.convert_to_tensor([input_ids])\n","print(input_ids)"],"metadata":{"id":"LGb3Q3hM7evX","colab":{"base_uri":"https://localhost:8080/"},"outputId":"1b41aa12-a110-4150-8ea7-a8e7b11332f0","executionInfo":{"status":"ok","timestamp":1677063459698,"user_tz":-540,"elapsed":285,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"execution_count":18,"outputs":[{"output_type":"stream","name":"stdout","text":["tf.Tensor([[ 9240  7894  9803  7155  7470  9040  9154 11357]], shape=(1, 8), dtype=int32)\n"]}]},{"cell_type":"code","source":["output = model.generate(input_ids,\n","                        max_length=128,\n","                        repetition_penalty=2.0,\n","                        use_cache=True)\n","output_ids = output.numpy().tolist()[0]\n","print(output_ids)\n","\n","# 모델로 output 생성 후 인코딩 형태로 출력"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"KsBMfhQ9Rxu1","outputId":"1feb011a-dc2f-43a9-a732-da24fe0ff200","executionInfo":{"status":"ok","timestamp":1677063487055,"user_tz":-540,"elapsed":27056,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"execution_count":19,"outputs":[{"output_type":"stream","name":"stdout","text":["[9240, 7894, 9803, 7155, 7470, 9040, 9154, 11357, 10635, 387, 9036, 7889, 7194, 9185, 9043, 16427, 10031, 9030, 9882, 12317, 16285, 11630, 9685, 9178, 26421, 9719, 7461, 24409, 9376, 11862, 9301, 9307, 9395, 11734, 9228, 12191, 9564, 15740, 9199, 14441, 7335, 8704, 33101, 9133, 10021, 10138, 30315, 21833, 9362, 18364, 11260, 8146, 7312, 7162, 18393, 13530, 11264, 10124, 7788, 33102, 9277, 10137, 9677, 9016, 8, 12199, 8711, 10033, 13805, 21734, 9045, 7888, 8325, 9563, 37043, 9184, 7763, 7244, 18398, 8031, 14596, 9023, 9772, 383, 11816, 384, 15389, 10125, 7210, 43403, 13803, 9643, 10402, 11511, 14531, 27502, 13946, 13729, 12940, 9062, 407, 16372, 12329, 12824, 9413, 10045, 11235, 22292, 12154, 9532, 14362, 8135, 9640, 27011, 9423, 10279, 8243, 45786, 7126, 9638, 28270, 8408, 7824, 11177, 8148, 10595, 11386, 16367]\n"]}]},{"cell_type":"code","source":["tokenizer.decode(output_ids)\n","\n","# 디코딩을 진행하여 한글로 변환"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":107},"id":"FS02AJQ5R16M","outputId":"08e90af8-6463-4350-cc7d-77c98fafadfa","executionInfo":{"status":"ok","timestamp":1677063487055,"user_tz":-540,"elapsed":25,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"execution_count":20,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'점심 메뉴를 정하기 위해서는 먼저, 한식당이나 일식, 양식 등 다양한 종류의 음식을 준비해야 한다.\\n특히 육류 위주의 식단은 피하고, 채소와 과일을 많이 먹는 것이 좋다.\\n또한 식사 후 바로 잠자리에 드는 것은 좋지 않다.\\n이때는 되도록이면 일찍 일어나서 식사를 하는 게 좋다.</d> 지난해 12월 31일 오후 2시쯤 서울 강남구 역삼동 강남역 인근에서 A(30)씨가 몰던 승용차가 중앙선을 넘어 마주 오던 택시와 충돌했다.\\nA씨는 사고 직후 병원으로 옮겨졌으나 숨졌다.\\n경찰은 “사고 당시 혈중알코올농도가 면허취소 수준인 0.089'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":20}]},{"cell_type":"markdown","source":["# 2. Numpy로 Top 5 뽑기"],"metadata":{"id":"iUEV2Y_MxX12"}},{"cell_type":"code","source":["import numpy as np"],"metadata":{"id":"eAmF4-N-Uwl9","executionInfo":{"status":"ok","timestamp":1677062849866,"user_tz":-540,"elapsed":300,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"execution_count":11,"outputs":[]},{"cell_type":"code","source":["output = model(input_ids)"],"metadata":{"id":"MhjZZyMo8Q6o","executionInfo":{"status":"ok","timestamp":1677063560815,"user_tz":-540,"elapsed":417,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"execution_count":21,"outputs":[]},{"cell_type":"code","source":["output.logits"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"siIG0sJd8Vwf","outputId":"b98af54e-ac3a-4a80-ebae-d84ba421b9e9","executionInfo":{"status":"ok","timestamp":1677063560815,"user_tz":-540,"elapsed":4,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"execution_count":22,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<tf.Tensor: shape=(1, 8, 51200), dtype=float32, numpy=\n","array([[[-5.3742495 , -6.129846  , -5.0250072 , ..., -2.9671474 ,\n","         -4.0192575 , -3.2595193 ],\n","        [-5.8983784 , -6.2681055 , -5.3119273 , ..., -5.0770445 ,\n","         -4.6411476 , -2.9729548 ],\n","        [-2.3717806 , -4.987067  , -5.0516014 , ..., -2.4364238 ,\n","         -2.4585614 , -0.22830462],\n","        ...,\n","        [-3.6832738 , -5.5499845 , -6.444559  , ..., -4.1256704 ,\n","         -6.0927725 , -1.4877555 ],\n","        [-5.264836  , -4.6400323 , -7.035182  , ..., -2.8357887 ,\n","         -4.7988424 , -4.2473063 ],\n","        [-5.525996  , -6.010222  , -6.159484  , ..., -1.5147887 ,\n","         -3.5077348 , -1.3324822 ]]], dtype=float32)>"]},"metadata":{},"execution_count":22}]},{"cell_type":"code","source":["output.logits.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"XoswPgKP9gtz","outputId":"3705b606-80fe-4da4-fb13-8eac96c3dd70","executionInfo":{"status":"ok","timestamp":1677063561115,"user_tz":-540,"elapsed":3,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"execution_count":23,"outputs":[{"output_type":"execute_result","data":{"text/plain":["TensorShape([1, 8, 51200])"]},"metadata":{},"execution_count":23}]},{"cell_type":"code","source":["top5 = tf.math.top_k(output.logits[0, -1], k=5)"],"metadata":{"id":"nNKR7l7s9o9v","executionInfo":{"status":"ok","timestamp":1677063561455,"user_tz":-540,"elapsed":2,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"execution_count":24,"outputs":[]},{"cell_type":"code","source":["tokenizer.convert_ids_to_tokens(top5.indices.numpy())\n","\n","#  점심 메뉴를 정하기 위해서는 먼저 -> 먼저를 선택"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"G_KrDJSf9q9w","outputId":"bf313d5f-d25d-4e67-936b-ac918c18a0d7","executionInfo":{"status":"ok","timestamp":1677063561894,"user_tz":-540,"elapsed":5,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"execution_count":25,"outputs":[{"output_type":"execute_result","data":{"text/plain":["['▁메', '▁먼저', '▁우선', '▁한', '▁점']"]},"metadata":{},"execution_count":25}]},{"cell_type":"markdown","source":["# 3. Numpy Top 5로 문장 생성하기"],"metadata":{"id":"pLoSP3hkxbdn"}},{"cell_type":"code","source":["sent = '점심 메뉴를 정하기 위해서는'\n","input_ids = tokenizer.encode(sent)\n","\n","# 확률이 높은 5개를 뽑아 그 중 random.choice를 진행"],"metadata":{"id":"Xz6W5lnYu2Wm","executionInfo":{"status":"ok","timestamp":1677063713429,"user_tz":-540,"elapsed":7,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"execution_count":29,"outputs":[]},{"cell_type":"code","source":["import random\n","\n","while len(input_ids) < 50:\n","    output = model(np.array([input_ids]))\n","    top5 = tf.math.top_k(output.logits[0, -1], k=5)\n","    token_id = random.choice(top5.indices.numpy())\n","    input_ids.append(token_id)"],"metadata":{"id":"AE3grFQsuuh-","executionInfo":{"status":"ok","timestamp":1677063725083,"user_tz":-540,"elapsed":11659,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"execution_count":30,"outputs":[]},{"cell_type":"code","source":["tokenizer.decode(input_ids)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":71},"id":"zuOhhfGQwAUZ","outputId":"e4b897db-068a-4550-b935-4811e0b145ab","executionInfo":{"status":"ok","timestamp":1677063725084,"user_tz":-540,"elapsed":7,"user":{"displayName":"임청수","userId":"12912954066416405673"}}},"execution_count":31,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'점심 메뉴를 정하기 위해서는 점심과 함께 저녁으로 이어지는 식사를 할 때 식사 시간을 충분히 확보하는 편이 바람직하다. 가족 단위 고객은 식사 시간을 여유로워할 가능성이 높다.\\n또한 저녁 식사 후 저녁 식사가 마무리될 때 마스크와'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":31}]}]}